<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Oblig1</title>
    <script type="application/javascript">
        const kjopBilletter = [];

        function kjopBillett() {
            const film = document.getElementById("valgtFilm").value;
            const antall = document.getElementById("antallB").value;
            const forNavn = document.getElementById("fNavn").value;
            const etterNavn = document.getElementById("eNavn").value;
            const telefoner = parseInt(document.getElementById("tlf").value);
            const epost = document.getElementById("epost").value;

            let gyldigInput = true;

            if (film === '') {
                document.getElementById("feilInput").innerHTML = '';
                return  false;
            }
                document.getElementById("feilInput").innerHTML = '';


            if (isNaN(antall) || antall === '') {
                document.getElementById("feiltall").innerHTML = 'Antall må velges.'.fontcolor("red");
                gyldigInput = false;
            } else {
                document.getElementById("feiltall").innerHTML = '';
            }

            if (forNavn === '') {
                document.getElementById("feilnNavn").innerHTML = 'Må skrive fornavn.'.fontcolor("red");
                gyldigInput = false;
            } else {
                document.getElementById("feilnNavn").innerHTML = "";
            }

            if (etterNavn === '') {
                document.getElementById("feilEtternavn").innerHTML = 'Må skrive etternavn.'.fontcolor("red");
                gyldigInput= false;
            } else {
                document.getElementById("feilEtternavn").innerHTML = "";
            }

            //for validering av telfoner, bruker en enkelt regex pattern på 8 digits(tilsvare norske mobil nummer).

            const gyldigTelegonnr=/^\d{8}$/;
            if (isNaN(telefoner) || telefoner === '' || !gyldigTelegonnr.test(telefoner)) {
                document.getElementById("feilTlf").innerHTML = 'Må skrive gyldig telefonnr.'.fontcolor("red");
                gyldigInput= false;
            } else {
                document.getElementById("feilTlf").innerHTML = "";
            }

            //bruker en regex pattern også for validering epost.
            const gyldigEpost= /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (epost === '' || !gyldigEpost.test(epost)) {
                document.getElementById("feilEpost").innerHTML = 'Må skrive gyldig epost.'.fontcolor("red");
               gyldigInput = false;
            } else {
                document.getElementById("feilEpost").innerHTML = "";
            }

            if (!gyldigInput) {
                return;
            }

            // Fjern feilmeldinger når input er gyldig.
            document.getElementById("feilInput").innerHTML = '';
            document.getElementById("feiltall").innerHTML = '';
            document.getElementById("feilnNavn").innerHTML = '';
            document.getElementById("feilEtternavn").innerHTML = '';
            document.getElementById("feilTlf").innerHTML = '';
            document.getElementById("feilEpost").innerHTML = '';

            const billetInfo = {
                film: film,
                antall: antall,
                fornavn: forNavn,
                etternavn: etterNavn,
                telefoner: telefoner,
                epost: epost
            };

            kjopBilletter.push(billetInfo);

            // Printer ut
            let utskrift;
            utskrift = "<table><tr><th>Film</th><th>Antall</th><th>Fornavn</th>" +
                "<th>Etternavn</th><th>Telefonnr</th><th>Epost</th></tr>";

            for (let i of kjopBilletter) {
                utskrift += "<tr><td>" + i.film + "</td><td>" + i.antall +
                    "</td><td>" + i.fornavn + "</td><td>" + i.etternavn + "</td><td>" +
                    i.telefoner + "</td><td>" + i.epost + "</td></tr>";
            }

            //tommer arrayet
            document.getElementById("utskrift").innerHTML = utskrift;
            document.getElementById("valgtFilm").value = "";
            document.getElementById("antallB").value = "";
            document.getElementById("fNavn").value = "";
            document.getElementById("eNavn").value = "";
            document.getElementById("tlf").value = "";
            document.getElementById("epost").value = "";
        }

        function slettBilletter() {
            kjopBilletter.length = 0;
            document.getElementById("utskrift").innerHTML = "";
        }
    </script>
</head>
<body>
<h1>Bestilling av Kinobiletter</h1>
<form onsubmit="event.preventDefault(); kjopBillett();">
    <label for="valgtFilm">Velg film</label>
    <select id="valgtFilm">
        <option value="" disabled selected>Velg film her</option>
        <option>The Beekeeper</option>
        <option>Killers of the Flower Moon</option>
        <option>Sound of Freedom</option>
        <option>Radical</option>
    </select>
    <span id="feilInput" ></span><br/><br/>
    <label for="antallB">Antall</label>
    <input type="number" id="antallB" min="1" max="99">
    <span id="feiltall"></span>
    <br/><br/>
    <table>
        <tr><td>Fornavn</td>
            <td><input type="text" id="fNavn">
                <span id="feilnNavn"></span></td></tr>
        <tr><td>Etternavn</td>
            <td><input type="text" id="eNavn">
                <span id="feilEtternavn"></span></td></tr>
        <tr><td>Telefonnr</td>
            <td><input type="tel" id="tlf" placeholder="12345678">
                <span id="feilTlf"></span></td></tr>
        <tr><td>Epost</td>
            <td><input type="text" id="epost" placeholder="example@example.com">
                <span id="feilEpost"></span></td></tr>
        <tr><td><button onclick="kjopBillett()">Kjøp billett</button>
        </td></tr>
    </table>
</form>
<h3>Alle Billetter</h3>
<div id="utskrift"></div><br/>
<button onclick="slettBilletter()">Slett alle billettene</button>

</body>
</html>